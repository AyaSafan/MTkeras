# MTKeras docs
MTKeras is a Metamorphic Testing tool for testing machine learning applications on top of Keras. 

## Authors
Yelin Liu and Zhi Quan Zhou, University of Wollongong and Morphick Solutions Pty Ltd, Australia.

## Publication and citation
Cite: Yelin Liu, Yang Liu, Tsong Yueh Chen, and Zhi Quan Zhou, "A Testing Tool for Machine Learning Applications," in Proceedings of the IEEE/ACM 5th International Workshop on Metamorphic Testing, 2020. ACM.

## Table of Contents
### [1. Overview](#Overview)
    Introduction to MTKeras
### [2. APIs](#APIs)
    Documentation for the functions included in MTKeras
### [3. Examples](#Examples)
    Introductory examples
### [4. Glossary](#Glossary)
    Definitions of common terms
## Overview
Machine learning (ML) platforms and libraries, such as TensorFlow and Theano, are now widely available to allow users to develop and train their own ML models. We have built our MT framework, MTKeras, on the Kerasplatform.Keras (https://keras.io) is a popular high-level neural networks API, developed in Python and working on top of low-level libraries—those backend engines such as Tensorflow and Theano  can be plugged seamlessly into Keras. The Keras API empowers users to configure and train a neural network model based on datasets for various tasks such as image classification or sentiment analysis. MTKeras enables automated metamorphic testing by providing the users with an MR library for testing their ML models and applications. <br/>
We have designed the MR library based on the concept of a hierarchical structure (levels of abstractions) of MRPs. MTKeras also allows the users to define and run new MRs through the composition of multiple MRs.The source test cases are provided by the users whereas followup test cases are generated by MTKeras. MR-violation tests are automatically recorded during testing.
## APIs

### Implementation:
1. download the Mtkeras package to the same folder of the targeted script (the Mtkeras package should be in the same folder of the target script). Otherwise, the user can download the package from github(https://github.com/lawrence415610/Mtkeras.git)
2. import the class using the command ```from Mtkeras.Mtkeras import Mtkeras```, the user import the Mtkeras class from a Mtkeras module.
3. the user can perform MT in a simple and intuitive way by writing a single line of code in the following format : 
    ```Mtkeras(<sourceTestSet>,<dataType>[,<modelName>]).<MRIPs>[.<MROP>].```

### Args:
- myTestSet: an array or ndarray that contains image data or other kind of data. Each pieces of data should be a seperate array, and all these array should be stored in one array, which is the myTestSet array.
- dataType: a string that can represent the context of the software undertest, it can be:
    1. grayscaleImage
    2. colorImage
    3. text
- model: an object. It is the neural network model undertest, if the Mtkeras is only used for test case generation, this argument can be omitted. The "model" argument is needed only when MROP is performed. 

### Returns:
It will return a Mtkeras object, by calling different attributes, the returns will be different.
- return a tranformed dataset(an array/ndarray), call the attribute ".myTestSet"
- return a dataset of violating cases, call the attribute ".violatingCases"

### permutative:
- Summary:
    The "permutative" MRIP: the user can shuffle the order of the data randomly in the dataset

- Args: 
    None

- Returns:
    - a Mtkeras Object
    - call the property ".myTestSet" to return a tranformed dataset(an array/ndarray)

### additive:
- Summary: 
    The "additive" MRIP: increase (or decrease) numerical values by a constant for each pieces of data in the dataset

- Args:
    - n_additive: integer, the constant that is used to change each pieces of data

- Returns:
    - a Mtkeras Object
    - call the property ".myTestSet" to return a tranformed dataset(an array/ndarray)

### brightness:
- Summary:
    The "brightness" MRIP: for images, this MRIP can adjust the image's brightness. It transforms the input image pixelwise according to the equation O = I**gamma after scaling each pixel to the range 0 to 1

- Args:
    - gamma(optional): float, non negative real number, the default value is 1
    - gain(optional): float, the constant multiplier. Default value is 1

- Returns:
    - a Mtkeras Object
    - call the property ".myTestSet" to return a tranformed dataset(an array/ndarray)

### multiplicative:
- Summary:
    the "multiplicative" MRIP: multiply numerical values by a constant for each pieces of data in the dataset

- Args:
    - n_mul: integer, the constant used for multiplying the dataset

- Returns:
    - a Mtkeras Object
    - call the property ".myTestSet" to return a tranformed dataset(an array/ndarray)

### invertive:
- Summary:
    the "invertive" MRIP: invert the element in the dataset

- Args:
    None

- Returns:
    - a Mtkeras Object
    - call the property ".myTestSet" to return a tranformed dataset(an array/ndarray)

### noise:
- Summary:
    the "noise" MRIP: create one or more noise points in a dataset

- Args:
    - n_noise: integer, n_noise>=0, the number of the noise point that is added to the dataset 

- Returns:
    - a Mtkeras Object
    - call the property ".myTestSet" to return a tranformed dataset(an array/ndarray)

### fliph:
- Summary:
    the "fliph" MRIP: flip the data horizontally

- Args:
    None

- Returns:
    - a Mtkeras Object
    - call the property ".myTestSet" to return a tranformed dataset(an array/ndarray)

### flipv:
- Summary:
    the "flipv" MRIP: flip the data vertically

- Args:
    None

- Returns:
    - a Mtkeras Object
    - call the property ".myTestSet" to return a tranformed dataset(an array/ndarray)

### rotate:
- Summary:
    the "rotation" MRIP: rotate the data, 

- Args:
    -n_deg: float, specify the degree that the image rotate

- Returns:
    - a Mtkeras Object
    - call the property ".myTestSet" to return a tranformed dataset(an array/ndarray)

### equal
- Summary:
    the "equal" MROP: the output of the first dataset should be equal to the second test dataset

- Args:
    none

- Returns:
    - a Mtkeras Object
    - call the property ".myTestSet" to return a tranformed dataset(an array/ndarray)
    - call the property ".violatingCases" to return a dataset of violating cases

- Outputs:
    the number of the violation cases will be printed

## License
MIT License

Copyright (c) 2020 Yelin Liu, Zhiquan (George) Zhou

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

## Glossary
- machine learning testing(ML testing): activities designed to reveal the flaws in machine learning items that can result in discordance between the existing and the required conditions.
- test oracle: A test oracle is a mechanism that can verify the test case results.
- Metamorphic testing(MT): a testing technique to alleviate the test oracle problem.
- Metamorphic relation(MR): the relations between inputs and outputs are defined as metamorphic relations which is considered as “derived oracles” that can alleviate the test oracle problem.
- Metamorphic relation pattern(MRP): defined the abstraction that features a set of (possibly infinitely many) metamorphic relations.
- metamorphic relation input pattern (MRIP): an abstraction that characterizes the relations among the source and follow-up inputs of a set of (possibly infinitely many) metamorphic relations.
- metamorphic relation output pattern(MROP): an abstraction that characterizes the relations among the source and follow-up outputs of a set of (possibly infinitely many) metamorphic relations.
